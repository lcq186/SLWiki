# MES 对接式确认书

版本履历

| V1.0.0 | 初始版本         | 2021.08.05 | 李传权 |      |
| ------ | ---------------- | ---------- | ------ | ---- |
| V1.0.1 | 样管导出数据格式 | 2021.10.12 | 李传权 |      |
|        |                  |            |        |      |
|        |                  |            |        |      |

<div style="page-break-after: always;"></div>

 ### 1. 原始需求文档

[**国星光电-白光 mes对接式样内容整理**](https://lcq186-1256847298.cos.ap-nanjing.myqcloud.com/DemandDoc/%E5%9B%BD%E6%98%9F/%E5%9B%BD%E6%98%9F%E5%85%89%E7%94%B5%20%E7%99%BD%E5%85%89%20mes%E5%AF%B9%E6%8E%A5%E5%BC%8F%E6%A0%B7%E6%95%B4%E7%90%86%281%29.docx)

### 2.项目背景

### 3.具体需求

#### 	3.1 模式选择

​		 工程模式 需要管理员密码,进入模式后和以往版本权限一样.

​		 生产模式  进入客户需求流程

#### 	3.2 基本信息加载

​		进入生产模式后 需要加载[固定资产号] 编号由操作员提供 ,如果文件不存在或查找失败,禁止进入生产模式.

​		[固定资产号] 文档提供 [操作员编辑工具]进行编辑添加,并且提供编辑记录. 自定义文件格式.

#### 	3.3 工单号获取

​		由MES 提供接口获取工单号.

​		 获取工单号失败禁止进行下一步操作,可以使用管理员编辑工单号等信息后解除禁用.

#### 	3.4 样管校正

​		第一次编辑程式后未进行样管校正,将不能进行下一步操作.

​		保存路径自定义设置.

​		数据格式由 MES提供.

​		导出csv格式数据

~~~csv
"系统识别名",aabbcc.PRG,"样管采用芯片数", 5 
," 1 - 1 ","项目名","补偿模式"
,,"VF1","平均Ave(a)"
,"a","b","误差范围(%)"
, 0 , 0 , 100 
"是否使用","样管值","测试值","误差(%)"
"Yes",0.000,10.000,
"Yes",0.000,10.000,
"Yes",0.000,10.000,
"Yes",0.000,10.000,
"Yes",0.000,10.000,
"No",,,
"No",,,
"No",,,
"No",,,
"No",,,
~~~

~~~c#
文件命名:JZ_[固定资产号]_[工单号]_[时间戳].json
文件格式:UTF-8
文件类型:Csv
~~~

#### 	3.5 点检测试

​		点检测试必须有补偿系数后才能进行测试.

​		 主界面添加一个类似批量测试模式,测试数据单独存放计数.

~~~c#
文件命名:DJ_[固定资产号]_[工单号]_[时间戳].CSV
~~~

#### 	3.6 批量测试数据分割.

​		根据用户设定最大行数进行数据分割,分割文件包含页眉内容. 

~~~
文件命名:LOT_[固定资产号]_[工单号]_[时间戳].CSV
~~~

#####      3.7 Bin率时间片数据截取

​		 根据用户设定起始时间和终止时间截取 这段时间内的Bin比率保存文件

​		数据格式由MES提供.

~~~
文件命名:BIN_[固定资产号]_[工单号]_[时间戳].json
~~~



### 4.流程图



![image-20210805113707131](https://lcq186-1256847298.cos.ap-nanjing.myqcloud.com/img/image-20210805113707131.png)



![image-20210805105227118](https://lcq186-1256847298.cos.ap-nanjing.myqcloud.com/img/image-20210805105227118.png)